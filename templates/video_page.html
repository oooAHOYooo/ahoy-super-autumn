{% extends "base.html" %}

{% block title %}{{ video.title }} - AHOY Indie Media{% endblock %}

{% block extra_css %}
<style>
/* Video Page Styles - Based on working test */
body { 
    font-family: Arial, sans-serif; 
    background: #f5f5f5;
}

.container {
    max-width: 1000px;
    margin: 0 auto;
    background: white;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.video-header {
    text-align: center;
    margin-bottom: 2rem;
}

.video-header h1 {
    font-size: 2.5rem;
    color: var(--black);
    margin-bottom: 0.5rem;
}

.video-header .event-date {
    font-size: 1.2rem;
    color: var(--dark-gray);
    margin-bottom: 1rem;
}

.video-header .video-description {
    font-size: 1.1rem;
    color: var(--gray);
    max-width: 600px;
    margin: 0 auto 2rem;
    line-height: 1.6;
}

.video-wrapper {
    position: relative;
    width: 100%;
    max-width: 900px;
    margin: 0 auto;
    background: #000;
    border-radius: 8px;
    overflow: hidden;
    aspect-ratio: 16 / 9;
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
}

#main-video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: none;
    outline: none;
    object-fit: cover;
}

.video-info {
    text-align: center;
    margin-top: 2rem;
    padding: 1rem;
    background: var(--light-gray);
    border-radius: 8px;
}

.video-info p {
    margin: 0.5rem 0;
    color: var(--dark-gray);
}

.back-link {
    display: inline-block;
    margin-top: 2rem;
    padding: 0.75rem 1.5rem;
    background: var(--black);
    color: var(--white);
    text-decoration: none;
    border-radius: 4px;
    transition: background 0.3s;
}

.back-link:hover {
    background: var(--dark-gray);
}

.status {
    text-align: center;
    margin-top: 1rem;
    padding: 1rem;
    border-radius: 4px;
}

.status.success {
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
}

.status.error {
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
}

@media (max-width: 768px) {
    .container {
        padding: 1rem;
        margin: 0.5rem;
    }
    
    .video-header h1 {
        font-size: 2rem;
    }
    
    .video-wrapper {
        margin: 0;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="container">
    <div class="video-header">
        <h1>{{ video.title }}</h1>
        {% if event %}
        <div class="event-date">{{ event.date }} at {{ event.time }}</div>
        {% endif %}
        <div class="video-description">{{ video.description }}</div>
    </div>
    
    <div class="video-wrapper">
        <video id="main-video" controls preload="metadata">
            <source src="{{ video.url }}" type="video/quicktime">
            <source src="{{ video.url }}" type="video/mp4">
            <source src="{{ video.url }}" type="video/x-m4v">
            <source src="{{ video.url }}" type="application/octet-stream">
            Your browser does not support the video tag.
        </video>
    </div>
    
    <div id="status" class="status">Loading video...</div>
    
    <div class="video-info">
        {% if video.duration %}
        <p><strong>Duration:</strong> {{ video.duration }}</p>
        {% endif %}
        {% if video.file_size %}
        <p><strong>File Size:</strong> {{ video.file_size }}</p>
        {% endif %}
        {% if video.format %}
        <p><strong>Format:</strong> {{ video.format }}</p>
        {% endif %}
        {% if event %}
        <p><strong>Event:</strong> {{ event.title }}</p>
        <p><strong>Venue:</strong> {{ event.venue }}</p>
        {% endif %}
    </div>
    
    <div style="text-align: center;">
        <a href="/events" class="back-link">‚Üê Back to Events</a>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const video = document.getElementById('main-video');
    const status = document.getElementById('status');
    
    function updateStatus(message, isError = false) {
        status.innerHTML = message;
        status.className = 'status ' + (isError ? 'error' : 'success');
    }
    
    // Video event listeners
    video.addEventListener('loadstart', () => updateStatus('Video loading...'));
    video.addEventListener('loadedmetadata', () => updateStatus(`Video loaded - Duration: ${video.duration} seconds`));
    video.addEventListener('canplay', () => updateStatus('Video ready to play!'));
    video.addEventListener('error', (e) => updateStatus(`Video error: ${e.message || 'Unknown error'}`, true));
    
    // Load the video
    video.load();
});
</script>
{% endblock %}


